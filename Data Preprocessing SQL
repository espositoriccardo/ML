/* Data Preprocessing */
/* Generates a dataset with no duplicate values and 12-month data */

WITH one_year_sales AS (
     SELECT DISTINCT
           date,
           (month(date)) AS month,
           (year(date)) AS year,
           customer,
           sales
      FROM sales
     WHERE  date <= '30Nov2017'd
)

SELECT    month,
          year,
          customer,
          (SUM(sales)) AS total_sales
   FROM one_year_sales
GROUP BY month,
         year,
         customer
ORDER BY year,
         month,
         customer;
         
         
